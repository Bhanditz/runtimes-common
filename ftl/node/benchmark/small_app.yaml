# This is a 'small' node app, with 1 dependency (20th percentile of all node projects with dependencies)
steps:
# Build benchmark image with bazel
  - name:  'gcr.io/cloud-builders/bazel'
    args: ['run','ftl/node/benchmark:node_benchmark_image', '--', '--norun']
# Clone git repo
  - name:  'gcr.io/cloud-builders/git'
    args: ['clone','https://github.com/KevinGaudin/monsterid.js.git']
# Bazel build par file
  - name:  'gcr.io/cloud-builders/bazel'
    args: ['build','ftl:node_builder.par']
# Run benchmark on small app
  - name:  'bazel/ftl/node/benchmark:node_benchmark_image'
    args: ['--base', 'gcr.io/google-appengine/nodejs:latest',
           '--name', 'gcr.io/ftl-node-test/benchmark-small-app:latest',
           '--directory', '/workspace/monsterid.js',
           '--repo', 'KevinGaudin/monsterid.js']
